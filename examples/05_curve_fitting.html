<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Curve Fitting &#8212; pedon 0.0.12 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=3bbcec59"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="From k value to Gardner via HYPAGS + Curve Fitting Routine" href="06_hypags_curvefitting.html" />
    <link rel="prev" title="Parameter Estimation via HYPAGS" href="04_hypags.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Curve-Fitting">
<h1>Curve Fitting<a class="headerlink" href="#Curve-Fitting" title="Link to this heading">Â¶</a></h1>
<p><em>Martin Vonk (2025)</em></p>
<p>It can be usefull to go from one soil model to the other. When the soil parameters are known the soil water retention curve and hydraulic conductivity function can be fitted.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pedon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pe</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_compare</span><span class="p">(</span><span class="n">soilsample</span><span class="p">:</span> <span class="n">pe</span><span class="o">.</span><span class="n">SoilSample</span><span class="p">,</span> <span class="n">soilmodel</span><span class="p">:</span> <span class="n">pe</span><span class="o">.</span><span class="n">SoilModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Soil Sample&quot;</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">soilmodel</span><span class="o">.</span><span class="n">plot_swrc</span><span class="p">(</span>
        <span class="n">soilmodel</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fitted Soil Model </span><span class="si">{</span><span class="n">soilmodel</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">soilmodel</span><span class="o">.</span><span class="n">plot_hcf</span><span class="p">(</span><span class="n">soilmodel</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

    <span class="n">k_left</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">k</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">k_right</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">k</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">k_left</span><span class="p">,</span> <span class="n">k_right</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;|$\psi$| [cm]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ [-]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$K_s$ [cm/d]&quot;</span><span class="p">)</span>
    <span class="n">ncol</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
        <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
        <span class="n">columnspacing</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">handlelength</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">align_xlabels</span><span class="p">()</span>
    <span class="c1"># plt.close(f)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sn</span> <span class="o">=</span> <span class="s2">&quot;Sand&quot;</span>
<span class="n">soil</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">Soil</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">Genuchten</span><span class="p">,</span> <span class="s2">&quot;HYDRUS&quot;</span><span class="p">)</span>
<span class="n">soilm_genuchten</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">soil</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">)</span>
<span class="n">soilm_genuchten</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Genuchten(k_s=712.8, theta_r=0.045, theta_s=0.43, alpha=0.145, n=2.68, l=0.5)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">soilm_genuchten</span><span class="o">.</span><span class="n">k</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">soilm_genuchten</span><span class="o">.</span><span class="n">theta</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soilsample</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">SoilSample</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">)</span>
<span class="n">soilsample</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SoilSample(sand_p=None, silt_p=None, clay_p=None, rho=None, th33=None, th1500=None, om_p=None, m50=None, d10=None, d20=None)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soilm_panday</span> <span class="o">=</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">Panday</span><span class="p">)</span>
<span class="n">soilm_panday</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Panday(k_s=np.float64(571.7082734658234), alpha=np.float64(0.1461801619285099), beta=np.float64(2.6526588374857303), brook=np.float64(3.797937441596011), sr=np.float64(0.10452835613889336))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_compare</span><span class="p">(</span><span class="n">soilsample</span><span class="p">,</span> <span class="n">soilm_panday</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_05_curve_fitting_7_0.png" src="../_images/examples_05_curve_fitting_7_0.png" />
</div>
</div>
<p>The fit method finds the optimal curve through both the soil water retention curve and hydraulic conductivity function at the same time using the least squares algorithm. All parameters are subject to the optimization algorithm.</p>
<p>The fit method uses the optimization algorithm from the 1991 <a class="reference external" href="https://www.pc-progress.com/Documents/programs/retc.pdf">RETC Code for Quantifying the Hydraulic Functions of Unsaturated Soils</a> by M.Th. van Genuchten, F.J. Leij and S.R. Yates.</p>
<p>The objective function <span class="math notranslate nohighlight">\(O(b)\)</span> minimized is:</p>
<p>$ O(b) = <span class="math">\sum`^N\_{i=1}(w_i(:nbsphinx-math:</span>theta`_{o,i}-<span class="math">\theta</span>_i))^2 + <span class="math">\sum</span><sup>M_{i=N+1}(w_iW_1W_2(Y_{o,i}-Y_i))</sup>2$</p>
<p>Using the SciPy least-squares algorithm.</p>
<p>With <span class="math notranslate nohighlight">\(N\)</span> the number of <span class="math notranslate nohighlight">\(\theta\)</span> data points and <span class="math notranslate nohighlight">\(M\)</span> is the number of <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> data points</p>
<p><span class="math notranslate nohighlight">\(w_i\)</span> are the individual weight factors per measurements (by default 1 for each measurement)</p>
<p><span class="math notranslate nohighlight">\(W_1\)</span> is the weight factor for the hydraulic conductivity function with respect to the soil water retention (default is 0.1)</p>
<p><span class="math notranslate nohighlight">\(W_2\)</span> is the proportional weight factor for two different data types and elimination factor for different units. By default the formulation for <span class="math notranslate nohighlight">\(W_2 = \frac{(M-N)\sum^N_{i=1}w_i\theta_{o,i}}{N\sum^M_{i=N+1}w_i|Y_{o,i}|}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(Y\)</span> is indicates the for the logaritmic transform of such that <span class="math notranslate nohighlight">\(Y = log_{10}K\)</span>.</p>
<p>It can be favorable to only optimize the relative hydraulic conductivity function, and leave parameter k_s untouched. That kan be achieved by providing <code class="docutils literal notranslate"><span class="pre">k_s</span></code> to the fit method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soilm_panday</span> <span class="o">=</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">Panday</span><span class="p">,</span> <span class="n">k_s</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
<span class="n">soilm_panday</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Panday(k_s=np.float64(712.7999894094452), alpha=np.float64(0.14657623411049972), beta=np.float64(2.6437587979256927), brook=np.float64(3.8328536708431717), sr=np.float64(0.10448683153152591))
</pre></div></div>
</div>
<p>It is also possible to provide bounds for the parameter space. By default, the bounds argument is <code class="docutils literal notranslate"><span class="pre">None</span></code> which takes the stored parameter bounds per soil model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">panday_bounds</span> <span class="o">=</span> <span class="n">pe</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="s2">&quot;Panday&quot;</span><span class="p">)</span>
<span class="n">panday_bounds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p_ini</th>
      <th>p_min</th>
      <th>p_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>k_s</th>
      <td>50.00</td>
      <td>0.00100</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>theta_r</th>
      <td>0.02</td>
      <td>0.00001</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>theta_s</th>
      <td>0.40</td>
      <td>0.20000</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>alpha</th>
      <td>0.02</td>
      <td>0.00100</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>beta</th>
      <td>2.30</td>
      <td>1.00000</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>brook</th>
      <td>10.00</td>
      <td>1.00000</td>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">panday_bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;k_s&quot;</span><span class="p">,</span> <span class="s2">&quot;p_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">650</span>
<span class="n">panday_bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;k_s&quot;</span><span class="p">,</span> <span class="s2">&quot;p_ini&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">soilsample</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
<span class="n">soilm_panday</span> <span class="o">=</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">Panday</span><span class="p">,</span> <span class="n">pbounds</span><span class="o">=</span><span class="n">panday_bounds</span><span class="p">)</span>
<span class="n">soilm_panday</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Panday(k_s=np.float64(650.0024881306313), alpha=np.float64(0.14641136203923166), beta=np.float64(2.64744674802969), brook=np.float64(3.8182839905828785), sr=np.float64(0.10450412521086855))
</pre></div></div>
</div>
<p>Other available option are to print the optimization result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soilm_panday</span> <span class="o">=</span> <span class="n">soilsample</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">Panday</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SciPy Optimization Result
      message: `gtol` termination condition is satisfied.
     success: True
      status: 1
         fun: [ 2.220e-05  2.220e-05 ... -8.042e-05 -2.758e-04]
           x: [ 5.717e+02  4.495e-02  4.300e-01  1.462e-01  2.653e+00
                3.798e+00]
        cost: 5.556972728926372e-07
         jac: [[ 0.000e+00  0.000e+00 ...  0.000e+00  0.000e+00]
               [ 0.000e+00  0.000e+00 ...  0.000e+00  0.000e+00]
               ...
               [ 1.946e-06  0.000e+00 ... -4.053e-02 -1.764e-02]
               [ 1.946e-06  0.000e+00 ... -5.026e-02 -2.187e-02]]
        grad: [ 1.630e-14  3.304e-09 -3.688e-10  5.776e-09  1.076e-09
                5.679e-11]
  optimality: 1.777636707528239e-09
 active_mask: [0 0 0 0 0 0]
        nfev: 10
        njev: 10
</pre></div></div>
</div>
<p>To parse other parameters for W1, W2, and individual weights there are other keyword arguements that for the fit method.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pedon</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Pedon</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#examples">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_pedon_structure.html">Pedon Package Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_soil_models.html">Soil Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_datasets.html">Soil Parameter Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_pedotransfer_functions.html">Pedotransfer Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_hypags.html">Parameter Estimation via HYPAGS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Curve Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_hypags_curvefitting.html">From k value to Gardner via HYPAGS + Curve Fitting Routine</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../_api/modules.html">pedon</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Pedon</a><ul>
      <li>Previous: <a href="04_hypags.html" title="previous chapter">Parameter Estimation via HYPAGS</a></li>
      <li>Next: <a href="06_hypags_curvefitting.html" title="next chapter">From k value to Gardner via HYPAGS + Curve Fitting Routine</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Martin Vonk.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.0.4</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/examples/05_curve_fitting.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>